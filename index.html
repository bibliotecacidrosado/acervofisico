<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acervo Físico - Biblioteca</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        :root {
            --primary: #4e73df;
            --secondary: #858796;
            --success: #1cc88a;
            --danger: #e74a3b;
            --warning: #f6c23e;
            --light: #f8f9fc;
            --dark: #5a5c69;
        }
        
        body {
            background-color: #f8f9fc;
            font-family: 'Nunito', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary), #2e59d9);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .card {
            border-radius: 10px;
            box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15);
            margin-bottom: 1.5rem;
            border: none;
        }
        
        .stats-card {
            text-align: center;
            padding: 1.5rem;
            border-left: 4px solid;
        }
        
        .stats-card.primary { border-left-color: var(--primary); }
        .stats-card.success { border-left-color: var(--success); }
        .stats-card.warning { border-left-color: var(--warning); }
        
        .stats-number {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0.5rem 0;
        }
        
        .book-card {
            height: 100%;
            transition: transform 0.3s;
        }
        
        .book-card:hover {
            transform: translateY(-5px);
        }
        
        .book-cover {
            height: 180px;
            object-fit: cover;
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
            background: linear-gradient(45deg, #4e73df, #2e59d9);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3.5rem;
        }
        
        .available {
            color: var(--success);
            font-weight: 600;
        }
        
        .unavailable {
            color: var(--danger);
            font-weight: 600;
        }
        
        .search-box {
            position: relative;
            margin-bottom: 2rem;
        }
        
        .search-icon {
            position: absolute;
            left: 15px;
            top: 12px;
            color: var(--secondary);
        }
        
        .search-input {
            padding-left: 45px;
            border-radius: 50px;
            border: 1px solid #d1d3e2;
            height: 48px;
        }
        
        .search-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 0.2rem rgba(78, 115, 223, 0.25);
        }
        
        .filter-buttons .btn {
            border-radius: 50px;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .last-update {
            font-size: 0.9rem;
            color: var(--secondary);
        }
        
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 3rem;
        }
        
        .no-books {
            text-align: center;
            padding: 3rem;
            color: var(--secondary);
        }
        
        .footer {
            background-color: white;
            color: var(--dark);
            padding: 1.5rem 0;
            margin-top: 3rem;
            border-top: 1px solid #e3e6f0;
        }
        
        .badge-available {
            background-color: var(--success);
            color: white;
        }
        
        .badge-unavailable {
            background-color: var(--danger);
            color: white;
        }
        
        @media (max-width: 768px) {
            .stats-number {
                font-size: 1.5rem;
            }
            
            .book-cover {
                height: 150px;
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="display-5 fw-bold"><i class="fas fa-book me-2"></i>Acervo Físico</h1>
                    <p class="lead">Sistema de Gerenciamento de Livros</p>
                </div>
                <div class="col-md-4 text-md-end">
                    <div class="btn-group">
                        <button class="btn btn-outline-light" id="refresh-btn">
                            <i class="fas fa-sync-alt"></i> Atualizar
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
        <!-- Stats Section -->
        <div class="row mb-4">
            <div class="col-md-4">
                <div class="card stats-card primary">
                    <i class="fas fa-book fa-2x text-primary"></i>
                    <div class="stats-number" id="total-books">0</div>
                    <p class="text-muted mb-0">Total de Livros</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card stats-card success">
                    <i class="fas fa-check-circle fa-2x text-success"></i>
                    <div class="stats-number" id="available-books">0</div>
                    <p class="text-muted mb-0">Disponíveis</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card stats-card warning">
                    <i class="fas fa-clock fa-2x text-warning"></i>
                    <div class="last-update" id="last-update">Carregando...</div>
                    <p class="text-muted mb-0">Última Atualização</p>
                </div>
            </div>
        </div>

        <!-- Search and Filters -->
        <div class="card p-4 mb-4">
            <div class="row">
                <div class="col-md-6">
                    <div class="search-box">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" id="search-input" class="form-control search-input" placeholder="Buscar por título, autor ou gênero...">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="filter-buttons">
                        <button class="btn btn-outline-primary active" data-filter="all">Todos</button>
                        <button class="btn btn-outline-success" data-filter="available">Disponíveis</button>
                        <button class="btn btn-outline-danger" data-filter="unavailable">Indisponíveis</button>
                        <button class="btn btn-outline-secondary" id="reset-filters">
                            <i class="fas fa-times"></i> Limpar
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Loading Spinner -->
        <div class="loading-spinner" id="loading-spinner">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Carregando...</span>
            </div>
            <p class="mt-3">Carregando acervo...</p>
        </div>

        <!-- Books Grid -->
        <div class="row" id="books-container">
            <!-- Books will be loaded here -->
        </div>

        <!-- No Books Message -->
        <div class="no-books" id="no-books-message">
            <i class="fas fa-inbox fa-3x mb-3"></i>
            <h4>Nenhum livro encontrado</h4>
            <p>Tente ajustar os filtros de busca</p>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>Biblioteca</h5>
                    <p class="mb-0">Sistema de Acervo Físico</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="mb-0">Conectado ao Google Sheets</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const booksContainer = document.getElementById('books-container');
            const loadingSpinner = document.getElementById('loading-spinner');
            const noBooksMessage = document.getElementById('no-books-message');
            const searchInput = document.getElementById('search-input');
            const filterButtons = document.querySelectorAll('.filter-buttons .btn');
            const resetFiltersBtn = document.getElementById('reset-filters');
            const refreshBtn = document.getElementById('refresh-btn');
            const totalBooksElement = document.getElementById('total-books');
            const availableBooksElement = document.getElementById('available-books');
            const lastUpdateElement = document.getElementById('last-update');
            
            let allBooks = [];
            let currentFilter = 'all';
            let currentSearch = '';
            
            // Initialize the page
            function init() {
                showLoading();
                loadBooksFromGoogleSheets();
                setupEventListeners();
            }
            
            // Set up event listeners
            function setupEventListeners() {
                searchInput.addEventListener('input', function() {
                    currentSearch = this.value;
                    filterBooks();
                });
                
                filterButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        if (this.id === 'reset-filters') {
                            // Reset filters
                            currentFilter = 'all';
                            currentSearch = '';
                            searchInput.value = '';
                            
                            // Update button states
                            filterButtons.forEach(btn => {
                                if (btn.dataset.filter === 'all') {
                                    btn.classList.add('active');
                                } else {
                                    btn.classList.remove('active');
                                }
                            });
                        } else {
                            // Apply filter
                            currentFilter = this.dataset.filter;
                            
                            // Update button states
                            filterButtons.forEach(btn => {
                                if (btn === this) {
                                    btn.classList.add('active');
                                } else {
                                    btn.classList.remove('active');
                                }
                            });
                        }
                        
                        filterBooks();
                    });
                });
                
                refreshBtn.addEventListener('click', function() {
                    showLoading();
                    loadBooksFromGoogleSheets();
                });
            }
            
            // Show loading state
            function showLoading() {
                loadingSpinner.style.display = 'block';
                noBooksMessage.style.display = 'none';
                booksContainer.innerHTML = '';
            }
            
            // Load books from Google Sheets
            function loadBooksFromGoogleSheets() {
                // This would be replaced with your actual Google Sheets API integration
                // For demonstration, we're using a simulated response
                
                // Simulate API call delay
                setTimeout(() => {
                    // This is sample data - replace with your actual data structure
                    const sampleData = {
                        livros: [
                            {
                                titulo: "Dom Casmurro",
                                autor: "Machado de Assis",
                                genero: "Literatura Brasileira",
                                ano: "1899",
                                total: 5,
                                emprestados: 2,
                                disponiveis: 3,
                                status: "Disponível"
                            },
                            {
                                titulo: "O Cortiço",
                                autor: "Aluísio Azevedo",
                                genero: "Literatura Brasileira",
                                ano: "1890",
                                total: 3,
                                emprestados: 3,
                                disponiveis: 0,
                                status: "Indisponível"
                            },
                            {
                                titulo: "Iracema",
                                autor: "José de Alencar",
                                genero: "Romance Indianista",
                                ano: "1865",
                                total: 4,
                                emprestados: 1,
                                disponiveis: 3,
                                status: "Disponível"
                            },
                            {
                                titulo: "Memórias Póstumas de Brás Cubas",
                                autor: "Machado de Assis",
                                genero: "Literatura Brasileira",
                                ano: "1881",
                                total: 3,
                                emprestados: 0,
                                disponiveis: 3,
                                status: "Disponível"
                            },
                            {
                                titulo: "O Guarani",
                                autor: "José de Alencar",
                                genero: "Romance Indianista",
                                ano: "1857",
                                total: 2,
                                emprestados: 2,
                                disponiveis: 0,
                                status: "Indisponível"
                            },
                            {
                                titulo: "A Moreninha",
                                autor: "Joaquim Manuel de Macedo",
                                genero: "Romance Romântico",
                                ano: "1844",
                                total: 4,
                                emprestados: 1,
                                disponiveis: 3,
                                status: "Disponível"
                            }
                        ],
                        totalLivros: 21,
                        totalDisponiveis: 12,
                        ultimaAtualizacao: new Date().toISOString()
                    };
                    
                    allBooks = sampleData.livros;
                    
                    // Update stats
                    totalBooksElement.textContent = sampleData.totalLivros.toLocaleString('pt-BR');
                    availableBooksElement.textContent = sampleData.totalDisponiveis.toLocaleString('pt-BR');
                    
                    // Format and display last update time
                    const updateDate = new Date(sampleData.ultimaAtualizacao);
                    lastUpdateElement.textContent = updateDate.toLocaleString('pt-BR');
                    
                    // Render books
                    renderBooks(allBooks);
                    
                    // Hide loading spinner
                    loadingSpinner.style.display = 'none';
                }, 1500);
            }
            
            // Render books function
            function renderBooks(books) {
                booksContainer.innerHTML = '';
                
                if (books.length === 0) {
                    noBooksMessage.style.display = 'block';
                    return;
                }
                
                noBooksMessage.style.display = 'none';
                
                books.forEach(book => {
                    const bookCol = document.createElement('div');
                    bookCol.className = 'col-md-6 col-lg-4 mb-4';
                    
                    bookCol.innerHTML = `
                        <div class="card book-card">
                            <div class="book-cover">
                                <i class="fas fa-book"></i>
                            </div>
                            <div class="card-body">
                                <h5 class="card-title">${book.titulo}</h5>
                                <p class="card-text">
                                    <strong>Autor:</strong> ${book.autor}<br>
                                    <strong>Gênero:</strong> ${book.genero}<br>
                                    <strong>Ano:</strong> ${book.ano}<br>
                                    <strong>Total:</strong> ${book.total} | 
                                    <strong>Emprestados:</strong> ${book.emprestados}
                                </p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="${book.status === 'Disponível' ? 'available' : 'unavailable'}">
                                        <i class="fas ${book.status === 'Disponível' ? 'fa-check-circle' : 'fa-times-circle'} me-1"></i>
                                        ${book.status}
                                    </span>
                                    <span class="badge ${book.disponiveis > 0 ? 'badge-available' : 'badge-unavailable'}">
                                        ${book.disponiveis} disponível(eis)
                                    </span>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    booksContainer.appendChild(bookCol);
                });
            }
            
            // Filter books based on search and filter criteria
            function filterBooks() {
                let filteredBooks = allBooks;
                
                // Apply search filter
                if (currentSearch) {
                    const searchLower = currentSearch.toLowerCase();
                    filteredBooks = filteredBooks.filter(book => 
                        book.titulo.toLowerCase().includes(searchLower) ||
                        book.autor.toLowerCase().includes(searchLower) ||
                        book.genero.toLowerCase().includes(searchLower)
                    );
                }
                
                // Apply status filter
                if (currentFilter === 'available') {
                    filteredBooks = filteredBooks.filter(book => book.status === 'Disponível');
                } else if (currentFilter === 'unavailable') {
                    filteredBooks = filteredBooks.filter(book => book.status === 'Indisponível');
                }
                
                renderBooks(filteredBooks);
            }
            
            // Initialize the application
            init();
        });
    </script>
</body>
</html>
